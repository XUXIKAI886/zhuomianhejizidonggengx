# 登录系统产品需求文档 (PRD)

**版本:** 1.0
**日期:** 2025-07-31

## 1. 项目概述

### 1.1 项目背景
呈尚策划工具箱桌面应用目前缺少用户身份认证和权限管理机制，所有用户均可访问全部功能。为了实现用户个性化服务、数据安全管理以及未来商业化功能拓展，需要构建一套完整的用户认证和管理系统。

### 1.2 目标用户
- **管理员 (Admin):** 负责用户账号管理、系统配置和数据监控。
- **普通用户 (User):** 使用工具箱内的各种工具完成日常工作。

### 1.3 核心价值
- **安全性:** 通过用户认证和权限控制，保障系统和用户数据的安全。
- **个性化:** 为不同用户提供个性化的使用体验和数据统计。
- **可管理性:** 提供后台管理功能，方便对用户和系统进行统一管理。
- **可扩展性:** 为未来可能的付费功能、团队协作等高级功能奠定基础。

## 2. 功能需求详述

### 2.1 用户认证模块

#### 2.1.1 登录页面 (`/login`)
- **用户故事:**
  - 作为一名用户，我希望通过输入用户名和密码登录系统，以便访问我权限范围内的工具。
  - 作为一名用户，我希望能选择“记住密码”，这样就不用每次都输入密码。
  - 作为一名用户，我希望能选择“自动登录”，这样下次启动应用时可以直接进入主界面。
- **功能点:**
  - **F-AUTH-01:** 提供用户名和密码输入框。
  - **F-AUTH-02:** 密码输入框需支持内容遮罩显示。
  - **F-AUTH-03:** 提供“记住密码”复选框。
  - **F-AUTH-04:** 提供“自动登录”复选框。
  - **F-AUTH-05:** 提供“登录”按钮。
  - **F-AUTH-06:** 对输入进行前端校验（用户名、密码不能为空）。
  - **F-AUTH-07:** 登录时向后端验证凭据，并显示明确的登录结果提示（如“登录成功”、“用户名或密码错误”、“账号已被禁用”）。
  - **F-AUTH-08:** 登录成功后，管理员跳转至后台管理页 (`/admin`)，普通用户跳转至主应用页 (`/`)。

#### 2.1.2 退出登录
- **用户故事:**
  - 作为一名已登录用户，我希望能从主界面的用户菜单中安全退出登录，以保护我的账户安全。
- **功能点:**
  - **F-AUTH-09:** 在 Header 的用户下拉菜单中，提供“退出登录”选项。
  - **F-AUTH-10:** 点击后，清除当前用户的会话信息（Token、本地缓存等）。
  - **F-AUTH-11:** 退出后，页面跳转至登录页 (`/login`)。

### 2.2 后台管理模块 (`/admin`)

#### 2.2.1 用户管理
- **用户故事:**
  - 作为管理员，我希望能查看所有用户的列表，了解系统中有哪些账号。
  - 作为管理员，我希望能新增用户账号，为新员工分配系统访问权限。
  - 作为管理员，我希望能修改用户的基本信息，如重置他们的密码。
  - 作为管理员，我希望能禁用或启用某个用户账号，以控制其访问权限。
  - 作为管理员，我希望能删除某个不再需要的用户账号。
- **功能点:**
  - **F-ADMIN-01:** 仅限管理员角色访问 `/admin` 路由。
  - **F-ADMIN-02:** 以表格形式展示用户列表，包含字段：用户名、角色、状态（启用/禁用）、创建时间、最后登录时间。
  - **F-ADMIN-03:** 提供“新增用户”功能，可设置用户名、初始密码和角色。
  - **F-ADMIN-04:** 提供“编辑用户”功能，可修改用户名。
  - **F-ADMIN-05:** 提供“重置密码”功能，为指定用户生成新的随机密码或由管理员指定。
  - **F-ADMIN-06:** 提供“禁用/启用”切换功能，控制用户登录权限。
  - **F-ADMIN-07:** 提供“删除用户”功能，执行前需有二次弹窗确认。

#### 2.2.2 数据统计
- **用户故事:**
  - 作为管理员，我希望能看到每个用户对各个工具的使用情况，以评估工具价值和员工工作模式。
  - 作为管理员，我希望能看到各个工具的总点击次数和使用时长，以了解最受欢迎的工具。
- **功能点:**
  - **F-ADMIN-08:** 在管理后台展示关键数据看板。
  - **F-ADMIN-09:** 统计并展示每个用户的总使用时长。
  - **F-ADMIN-10:** 统计并展示每个工具的总点击次数和总使用时长。
  - **F-ADMIN-11:** 提供按用户或按工具筛选查看详细使用统计的功能。

### 2.3 主应用界面改造

#### 2.3.1 用户状态与信息
- **用户故事:**
  - 作为一名已登录用户，我希望能在应用头部看到我的用户名或头像，确认我当前的登录状态。
- **功能点:**
  - **F-MAIN-01:** 在 Header 组件中，将静态的用户信息替换为当前登录用户的实际信息（用户名、头像）。
  - **F-MAIN-02:** 用户未登录时，Header 应显示“未登录”状态或直接重定向到登录页。

#### 2.3.2 使用行为追踪
- **用户故事:**
  - (隐式) 系统需要记录我的操作，以便管理员进行数据分析和审计。
- **功能点:**
  - **F-MAIN-03:** 记录用户每次点击工具网格中的工具项（toolId, clickCount）。
  - **F-MAIN-04:** 当用户打开一个工具的 WebView 时，开始计时；当关闭时，停止计时，并记录使用时长（toolId, usageTime）。
  - **F-MAIN-05:** 记录用户的完整会话时长，从登录成功到退出登录或关闭应用。

## 3. 非功能性需求

- **NF-01 (安全性):**
  - 用户密码必须经过加密（如 bcrypt）后存储在数据库中。
  - 前后端通信需使用安全的认证机制（如 JWT）。
  - 对所有涉及敏感操作的后端接口进行严格的权限校验。
- **NF-02 (性能):**
  - 登录验证响应时间应在 500ms 以内。
  - 后台管理页面加载用户列表（百人级别）时间应在 1s 以内。
- **NF-03 (UI/UX):**
  - 所有新增界面的风格需与现有项目保持一致，复用 `shadcn/ui` 组件。
  - 交互流程应清晰、直观，错误提示友好。
- **NF-04 (数据持久化):**
  - 用户数据和统计数据需要可靠地持久化存储，确保应用重启后数据不丢失。
