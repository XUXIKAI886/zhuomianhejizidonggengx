# å‘ˆå°šç­–åˆ’å·¥å…·ç®±è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿéƒ¨ç½²æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

åŸºäºä½ çš„ GitHub ä»“åº“ `https://github.com/XUXIKAI886/zhuomianhejizidonggengx.git`ï¼Œæˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº†å®Œæ•´çš„ Vercel è‡ªåŠ¨æ›´æ–°æœåŠ¡å™¨ç³»ç»Ÿã€‚

## âœ… å·²å‡†å¤‡å¥½çš„æ–‡ä»¶

æˆ‘å·²ç»åœ¨ `update-server/` ç›®å½•ä¸­åˆ›å»ºäº†ä»¥ä¸‹å®Œæ•´çš„æ›´æ–°æœåŠ¡å™¨ä»£ç ï¼š

```
update-server/                    # æ›´æ–°æœåŠ¡å™¨æ ¹ç›®å½•
â”œâ”€â”€ api/                         # Vercel Serverless API
â”‚   â”œâ”€â”€ releases.js             # æ›´æ–°æ£€æŸ¥å’Œç‰ˆæœ¬ç®¡ç†API  
â”‚   â””â”€â”€ health.js               # å¥åº·æ£€æŸ¥API
â”œâ”€â”€ package.json                # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ vercel.json                 # Vercel éƒ¨ç½²é…ç½®
â”œâ”€â”€ index.html                  # ç²¾ç¾çš„æœåŠ¡çŠ¶æ€é¡µé¢
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md                   # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ ç«‹å³éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå°†æ›´æ–°æœåŠ¡å™¨ä»£ç æ¨é€åˆ°ä½ çš„ä»“åº“

```bash
# 1. å…‹éš†ä½ çš„ä»“åº“
git clone https://github.com/XUXIKAI886/zhuomianhejizidonggengx.git
cd zhuomianhejizidonggengx

# 2. å¤åˆ¶æ›´æ–°æœåŠ¡å™¨æ–‡ä»¶åˆ°ä»“åº“æ ¹ç›®å½•
# å°†æˆ‘åˆ›å»ºçš„ update-server ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°ä½ çš„ä»“åº“æ ¹ç›®å½•

# 3. æäº¤å¹¶æ¨é€åˆ° GitHub
git add .
git commit -m "feat: æ·»åŠ  Vercel è‡ªåŠ¨æ›´æ–°æœåŠ¡å™¨"
git push origin main
```

### ç¬¬äºŒæ­¥ï¼šåœ¨ Vercel ä¸­éƒ¨ç½²

#### 2.1 è¿æ¥ GitHub ä»“åº“åˆ° Vercel

1. è®¿é—® [Vercel Dashboard](https://vercel.com/dashboard)
2. ä½¿ç”¨ GitHub è´¦æˆ·ç™»å½•
3. ç‚¹å‡» **"New Project"**
4. åœ¨ "Import Git Repository" æ‰¾åˆ° `zhuomianhejizidonggengx`
5. ç‚¹å‡» **"Import"**

#### 2.2 é…ç½®é¡¹ç›®è®¾ç½®

**é¡¹ç›®é…ç½®ï¼š**
- **Framework Preset**: Other
- **Root Directory**: `./` (é»˜è®¤)
- **Build Command**: ç•™ç©º
- **Output Directory**: ç•™ç©º
- **Install Command**: `npm install`

#### 2.3 è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨éƒ¨ç½²å‰ï¼Œç‚¹å‡» **"Environment Variables"** æ·»åŠ ï¼š

```bash
# ç®¡ç†å‘˜è®¿é—®ä»¤ç‰Œï¼ˆå¿…éœ€ï¼‰
Name: ADMIN_TOKEN
Value: your-super-secret-admin-token-12345-make-it-strong

# API åŠ å¯†å¯†é’¥ï¼ˆå¯é€‰ï¼Œé¢å¤–å®‰å…¨å±‚ï¼‰
Name: ENCRYPTION_KEY  
Value: your-encryption-key-67890-for-security
```

**ç”Ÿæˆå¼ºå¯†ç å‘½ä»¤ï¼š**
```bash
# ä½¿ç”¨ Node.js ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# æˆ–ä½¿ç”¨åœ¨çº¿å·¥å…·ï¼šhttps://www.uuidgenerator.net/
```

#### 2.4 å®Œæˆéƒ¨ç½²

1. ç‚¹å‡» **"Deploy"** æŒ‰é’®
2. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆ1-2åˆ†é’Ÿï¼‰
3. è·å¾—ä½ çš„æ›´æ–°æœåŠ¡å™¨åœ°å€ï¼š`https://your-app-name.vercel.app`

### ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•æ›´æ–°æœåŠ¡å™¨

#### 3.1 å¥åº·æ£€æŸ¥æµ‹è¯•
```bash
curl https://your-app-name.vercel.app/health
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "status": "ok",
  "service": "å‘ˆå°šç­–åˆ’å·¥å…·ç®±è‡ªåŠ¨æ›´æ–°æœåŠ¡",
  "timestamp": "2024-01-30T12:00:00Z",
  "version": "1.0.0",
  "platform": "Vercel Serverless",
  "github_repo": "https://github.com/XUXIKAI886/zhuomianhejizidonggengx"
}
```

#### 3.2 æ›´æ–°æ£€æŸ¥æµ‹è¯•
```bash
curl https://your-app-name.vercel.app/api/releases/windows-x86_64/1.0.0
```

**é¢„æœŸå“åº”ï¼ˆå·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼‰ï¼š**
```json
{
  "version": "1.0.0",
  "notes": "",
  "pub_date": null,
  "platforms": {}
}
```

### ç¬¬å››æ­¥ï¼šé…ç½® Tauri æ›´æ–°ç«¯ç‚¹

ç¼–è¾‘ä½ çš„æ¡Œé¢åº”ç”¨é¡¹ç›®ä¸­çš„ `src-tauri/tauri.conf.json` æ–‡ä»¶ï¼š

#### 4.1 æ›´æ–°é…ç½®æ–‡ä»¶

å°†æ›´æ–°æœåŠ¡å™¨åœ°å€é…ç½®åˆ° Tauriï¼š

```json
{
  "plugins": {
    "updater": {
      "endpoints": [
        "https://your-app-name.vercel.app/api/releases/{{target}}/{{current_version}}"
      ],
      "dialog": true,
      "pubkey": "ä½ çš„æ•°å­—ç­¾åå…¬é’¥"
    }
  }
}
```

#### 4.2 ç”Ÿæˆæ•°å­—ç­¾åå¯†é’¥ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰

```bash
# ç”Ÿæˆå¯†é’¥å¯¹
tauri signer generate -w ~/.tauri/chengshang-tools.key

# è·å–å…¬é’¥å¹¶æ›´æ–°åˆ° tauri.conf.json
# ç§é’¥ç”¨äºç­¾åå‘å¸ƒåŒ…ï¼Œå…¬é’¥ç”¨äºéªŒè¯
```

## ğŸ”„ ç‰ˆæœ¬å‘å¸ƒæµç¨‹

### æ–¹å¼ä¸€ï¼šæ‰‹åŠ¨å‘å¸ƒæ–°ç‰ˆæœ¬

#### 1. æ„å»ºæ¡Œé¢åº”ç”¨
```bash
# åœ¨ä½ çš„æ¡Œé¢åº”ç”¨é¡¹ç›®ä¸­
npm run tauri build
```

#### 2. ä¸Šä¼ åˆ° GitHub Releases
```bash
# åˆ›å»ºæ–°æ ‡ç­¾
git tag v1.1.0
git push origin v1.1.0

# åœ¨ GitHub ä»“åº“åˆ›å»º Release å¹¶ä¸Šä¼ å®‰è£…åŒ…
# æ–‡ä»¶åç¤ºä¾‹: å‘ˆå°šç­–åˆ’å·¥å…·ç®±-1.1.0-setup.exe
```

#### 3. æ›´æ–°æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯
```bash
curl -X POST https://your-app-name.vercel.app/api/releases \
  -H "Authorization: Bearer your-admin-token" \
  -H "Content-Type: application/json" \
  -d '{
    "target": "windows-x86_64",
    "version": "1.1.0",
    "notes": "â€¢ ä¿®å¤äº†å·¥å…·å¯åŠ¨å¼‚å¸¸é—®é¢˜\nâ€¢ ä¼˜åŒ–äº†ç•Œé¢å“åº”é€Ÿåº¦\nâ€¢ æ–°å¢äº†æ‰¹é‡å¤„ç†åŠŸèƒ½",
    "signature": "ç”Ÿæˆçš„æ•°å­—ç­¾å",
    "url": "https://github.com/XUXIKAI886/zhuomianhejizidonggengx/releases/download/v1.1.0/å‘ˆå°šç­–åˆ’å·¥å…·ç®±-1.1.0-setup.exe"
  }'
```

### æ–¹å¼äºŒï¼šè‡ªåŠ¨åŒ–å‘å¸ƒï¼ˆæ¨èï¼‰

åˆ›å»º GitHub Actions è‡ªåŠ¨å‘å¸ƒå·¥ä½œæµï¼š

```yaml
# .github/workflows/release.yml
name: è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒ

on:
  push:
    tags:
      - 'v*'

jobs:
  build-and-release:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-node@v4
      with:
        node-version: '18'
    - name: æ„å»ºåº”ç”¨
      run: |
        npm install
        npm run tauri build
    - name: åˆ›å»º Release
      uses: softprops/action-gh-release@v1
      with:
        files: src-tauri/target/release/bundle/nsis/*.exe
```

## ğŸ”§ è‡ªå®šä¹‰åŸŸåé…ç½®ï¼ˆå¯é€‰ï¼‰

### 1. åœ¨ Vercel æ·»åŠ è‡ªå®šä¹‰åŸŸå

1. è¿›å…¥é¡¹ç›® â†’ Settings â†’ Domains  
2. æ·»åŠ åŸŸåï¼š`api.chengshangcehua.com`
3. æŒ‰æç¤ºé…ç½® DNS

### 2. DNS é…ç½®

```bash
# æ·»åŠ  CNAME è®°å½•
ç±»å‹: CNAME
åç§°: api
å€¼: cname.vercel-dns.com.
TTL: 300
```

### 3. æ›´æ–° Tauri é…ç½®

```json
{
  "plugins": {
    "updater": {
      "endpoints": [
        "https://api.chengshangcehua.com/api/releases/{{target}}/{{current_version}}"
      ],
      "dialog": true,
      "pubkey": "ä½ çš„æ•°å­—ç­¾åå…¬é’¥"
    }
  }
}
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å®æ—¶ç›‘æ§

- **Vercel Dashboard**: æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€å’Œå®æ—¶æ—¥å¿—
- **GitHub**: ç›‘æ§ä»“åº“æ›´æ–°å’Œ Issues
- **è‡ªå®šä¹‰ç›‘æ§**: å¯æ·»åŠ  Webhook é€šçŸ¥

### æ—¥å¿—æŸ¥çœ‹

```bash
# å®‰è£… Vercel CLIï¼ˆå¯é€‰ï¼‰
npm install -g vercel

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
vercel logs --follow

# æŸ¥çœ‹ç‰¹å®šå‡½æ•°æ—¥å¿—
vercel logs api/releases.js
```

### æ€§èƒ½ä¼˜åŒ–

- **ç¼“å­˜ç­–ç•¥**: Vercel è‡ªåŠ¨å¯ç”¨è¾¹ç¼˜ç¼“å­˜
- **å‹ç¼©**: è‡ªåŠ¨ Gzip/Brotli å‹ç¼©
- **CDN**: å…¨çƒ Edge Network åŠ é€Ÿ

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### 1. Token å®‰å…¨

- âœ… ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²ï¼ˆè‡³å°‘32ä½ï¼‰
- âœ… å®šæœŸè½®æ¢ç®¡ç†å‘˜ä»¤ç‰Œï¼ˆå»ºè®®æ¯3ä¸ªæœˆï¼‰
- âœ… ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- âœ… ä½¿ç”¨ Vercel ç¯å¢ƒå˜é‡ç®¡ç†

### 2. API å®‰å…¨

- âœ… æ‰€æœ‰è¯·æ±‚å¼ºåˆ¶ä½¿ç”¨ HTTPS
- âœ… ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… CORS ç­–ç•¥é…ç½®

### 3. ç‰ˆæœ¬ç­¾å

- âœ… æ¯ä¸ªå‘å¸ƒç‰ˆæœ¬å¿…é¡»æ•°å­—ç­¾å
- âœ… ç§é’¥å®‰å…¨å­˜å‚¨ï¼ˆå»ºè®®ä½¿ç”¨ HSMï¼‰
- âœ… å…¬é’¥é…ç½®åœ¨ Tauri é…ç½®ä¸­

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. éƒ¨ç½²å¤±è´¥**
```bash
# æ£€æŸ¥ package.json å’Œ vercel.json é…ç½®
# æŸ¥çœ‹ Vercel Dashboard æ„å»ºæ—¥å¿—
# ç¡®è®¤æ‰€æœ‰ä¾èµ–éƒ½å·²æ­£ç¡®å®‰è£…
```

**2. API è¿”å› 500 é”™è¯¯**
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
# æŸ¥çœ‹ Vercel Functions å®æ—¶æ—¥å¿—
# ç¡®è®¤ API ä»£ç è¯­æ³•æ— è¯¯
```

**3. è‡ªåŠ¨æ›´æ–°ä¸å·¥ä½œ**
```bash
# ç¡®è®¤ Tauri é…ç½®ä¸­çš„ endpoint åœ°å€æ­£ç¡®
# æ£€æŸ¥æ•°å­—ç­¾åå…¬é’¥é…ç½®
# éªŒè¯ç‰ˆæœ¬å·æ ¼å¼æ˜¯å¦ç¬¦åˆ semver è§„èŒƒ
```

### è°ƒè¯•æŠ€å·§

**æœ¬åœ°å¼€å‘ï¼š**
```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
npx vercel dev

# è®¿é—®æœ¬åœ°API
curl http://localhost:3000/health
```

**ç”Ÿäº§ç¯å¢ƒï¼š**
```bash
# æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
vercel ls

# æŸ¥çœ‹é¡¹ç›®ä¿¡æ¯
vercel inspect your-app-name.vercel.app
```

## ğŸ’° æˆæœ¬åˆ†æ

### Vercel å…è´¹é¢åº¦
- **å‡½æ•°æ‰§è¡Œæ—¶é—´**: 100 GB-å°æ—¶/æœˆ
- **å¸¦å®½**: 100 GB/æœˆ  
- **éƒ¨ç½²æ¬¡æ•°**: æ— é™åˆ¶
- **è‡ªå®šä¹‰åŸŸå**: æ— é™åˆ¶

### å®é™…ä½¿ç”¨é‡ä¼°ç®—
- **ç”¨æˆ·æ•°é‡**: 1000 ç”¨æˆ·
- **æ£€æŸ¥é¢‘ç‡**: æ¯å¤© 2 æ¬¡
- **æœˆè¯·æ±‚é‡**: 60,000 æ¬¡
- **å•æ¬¡å“åº”**: ~1KB
- **æœˆå¸¦å®½**: ~60MB
- **å‡½æ•°æ‰§è¡Œ**: ~0.83 å°æ—¶/æœˆ

**ç»“è®º**: å®Œå…¨åœ¨å…è´¹é¢åº¦å†…ï¼Œæˆæœ¬ **$0/æœˆ** ğŸ’°

## ğŸ‰ éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

è¯·ç¡®è®¤ä»¥ä¸‹é¡¹ç›®å·²å®Œæˆï¼š

### åŸºç¡€éƒ¨ç½²
- [ ] æ›´æ–°æœåŠ¡å™¨ä»£ç å·²æ¨é€åˆ° GitHub ä»“åº“
- [ ] Vercel é¡¹ç›®æˆåŠŸåˆ›å»ºå¹¶è¿æ¥ GitHub
- [ ] ç¯å¢ƒå˜é‡ `ADMIN_TOKEN` å·²æ­£ç¡®é…ç½®
- [ ] éƒ¨ç½²æˆåŠŸå®Œæˆï¼Œè·å¾— Vercel åº”ç”¨åœ°å€
- [ ] å¥åº·æ£€æŸ¥ API è¿”å›æ­£å¸¸ï¼š`/health`
- [ ] æ›´æ–°æ£€æŸ¥ API å“åº”æ­£å¸¸ï¼š`/api/releases/windows-x86_64/1.0.0`

### åº”ç”¨é›†æˆ
- [ ] Tauri é…ç½®æ–‡ä»¶å·²æ›´æ–°æ›´æ–°æœåŠ¡å™¨åœ°å€
- [ ] æ•°å­—ç­¾åå¯†é’¥å¯¹å·²ç”Ÿæˆ
- [ ] å…¬é’¥å·²é…ç½®åˆ° `tauri.conf.json`
- [ ] æ¡Œé¢åº”ç”¨è‡ªåŠ¨æ›´æ–°åŠŸèƒ½æµ‹è¯•é€šè¿‡

### ç‰ˆæœ¬ç®¡ç†
- [ ] ç‰ˆæœ¬å‘å¸ƒ API æµ‹è¯•é€šè¿‡
- [ ] GitHub Releases å‘å¸ƒæµç¨‹éªŒè¯
- [ ] æ•°å­—ç­¾åå’ŒéªŒè¯æµç¨‹æ­£å¸¸
- [ ] ç‰ˆæœ¬å›æ»šæœºåˆ¶æµ‹è¯•é€šè¿‡

### ç›‘æ§è¿ç»´  
- [ ] Vercel Dashboard ç›‘æ§é…ç½®
- [ ] é”™è¯¯æ—¥å¿—å’Œå‘Šè­¦è®¾ç½®
- [ ] æ€§èƒ½ç›‘æ§æŒ‡æ ‡æ­£å¸¸
- [ ] å¤‡ä»½å’Œæ¢å¤æµç¨‹ç¡®è®¤

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³éƒ¨ç½²**: æŒ‰ç…§æœ¬æŒ‡å—å®Œæˆ Vercel éƒ¨ç½²
2. **åŠŸèƒ½æµ‹è¯•**: å…¨é¢æµ‹è¯•æ‰€æœ‰ API æ¥å£
3. **åº”ç”¨é›†æˆ**: æ›´æ–°æ¡Œé¢åº”ç”¨é…ç½®å¹¶æµ‹è¯•
4. **é¦–æ¬¡å‘å¸ƒ**: å‡†å¤‡å¹¶å‘å¸ƒç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬
5. **ç›‘æ§ä¼˜åŒ–**: è®¾ç½®å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**: é¦–å…ˆæ£€æŸ¥ Vercel Dashboard ä¸­çš„å‡½æ•°æ—¥å¿—
2. **GitHub Issues**: åœ¨ä»“åº“ä¸­åˆ›å»º Issue æè¿°é—®é¢˜
3. **é‡æ–°éƒ¨ç½²**: å°è¯•é‡æ–°è§¦å‘éƒ¨ç½²è§£å†³ä¸´æ—¶é—®é¢˜
4. **å›æ»šç‰ˆæœ¬**: å¦‚æœ‰é—®é¢˜å¯å¿«é€Ÿå›æ»šåˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬

---

## ğŸš€ æ­å–œï¼

ä½ ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ª**ä¼ä¸šçº§ã€å…¨çƒåŠ é€Ÿã€é›¶æˆæœ¬**çš„è‡ªåŠ¨æ›´æ–°æœåŠ¡å™¨ï¼

**ä¸»è¦ä¼˜åŠ¿ï¼š**
- âœ… **Git æ¨é€è‡ªåŠ¨éƒ¨ç½²** - ç°ä»£åŒ– DevOps å·¥ä½œæµ
- âœ… **å…¨çƒ CDN åŠ é€Ÿ** - Vercel Edge Network  
- âœ… **ä¼ä¸šçº§å¯é æ€§** - 99.99% æœåŠ¡å¯ç”¨æ€§
- âœ… **é›¶è¿ç»´æˆæœ¬** - æ— éœ€æœåŠ¡å™¨ç®¡ç†
- âœ… **å®Œæ•´çš„å®‰å…¨ä¿æŠ¤** - Token è®¤è¯ + æ•°å­—ç­¾å

ç°åœ¨å¼€å§‹äº«å— **`git push` å³å¯æ›´æ–°ç”Ÿäº§ç¯å¢ƒ** çš„ä¾¿åˆ©å§ï¼ğŸ‰