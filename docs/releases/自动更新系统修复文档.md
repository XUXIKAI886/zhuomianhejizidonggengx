# è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿä¿®å¤æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†å‘ˆå°šç­–åˆ’å·¥å…·ç®±æ¡Œé¢åº”ç”¨è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿçš„ä¿®å¤è¿‡ç¨‹ï¼ŒåŒ…æ‹¬IPCé€šä¿¡é—®é¢˜è§£å†³ã€ç‰ˆæœ¬æ¼”è¿›å†ç¨‹ã€çª—å£å°ºå¯¸ä¼˜åŒ–ä»¥åŠç”¨æˆ·ä½“éªŒæ”¹è¿›ç­‰å…³é”®æŠ€æœ¯ç»†èŠ‚ã€‚

**ä¿®å¤æ—¶é—´èŒƒå›´**ï¼š2025å¹´7æœˆ31æ—¥  
**æ¶‰åŠç‰ˆæœ¬**ï¼šv1.0.12 â†’ v1.0.13 â†’ v1.0.15  
**ä¸»è¦é—®é¢˜**ï¼šTauri IPCé€šä¿¡å¤±è´¥ã€ç‰ˆæœ¬æ£€æµ‹é”™è¯¯ã€ç”¨æˆ·ç•Œé¢ä¼˜åŒ–

---

## ğŸš¨ æ ¸å¿ƒé—®é¢˜åˆ†æ

### 1. IPCé€šä¿¡é—®é¢˜

#### é—®é¢˜æè¿°
```
é”™è¯¯ä¿¡æ¯ï¼šmissing Origin header
APIè°ƒç”¨ï¼šplugin:app|version è¿”å›500é”™è¯¯
å½±å“åŠŸèƒ½ï¼šç‰ˆæœ¬è·å–ã€æ›´æ–°æ£€æŸ¥
```

#### æ ¹æœ¬åŸå› 
- Tauri IPCé€šä¿¡é…ç½®ä¸å½“
- CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰é™åˆ¶è¿‡ä¸¥
- å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒé…ç½®ä¸ä¸€è‡´

#### è§£å†³æ–¹æ¡ˆ
```json
// src-tauri/tauri.conf.json
"security": {
  "csp": "default-src 'self' ipc: http://ipc.localhost; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' ipc: http://ipc.localhost https://www.yujinkeji.asia https://api.github.com https://github.com;",
  "dangerousDisableAssetCspModification": false
}
```

### 2. ç‰ˆæœ¬æ£€æµ‹é”™è¯¯

#### é—®é¢˜æè¿°
- åº”ç”¨æ˜¾ç¤ºç‰ˆæœ¬ä¸å®é™…å®‰è£…ç‰ˆæœ¬ä¸ç¬¦
- ç¡¬ç¼–ç ç‰ˆæœ¬å·å¯¼è‡´æ£€æµ‹å¤±è´¥
- ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬å·ä¸åŒ¹é…

#### è§£å†³ç­–ç•¥
é‡‡ç”¨å¤šå±‚fallbackæœºåˆ¶ï¼š
```typescript
// ç‰ˆæœ¬è·å–é€»è¾‘
1. å°è¯•Tauri APIè·å– â†’ å¤±è´¥æ—¶
2. ä½¿ç”¨é…ç½®æ–‡ä»¶ç‰ˆæœ¬ â†’ å¤±è´¥æ—¶  
3. ä½¿ç”¨é»˜è®¤fallbackç‰ˆæœ¬
```

---

## ğŸ“ˆ ç‰ˆæœ¬æ¼”è¿›å†ç¨‹

### v1.0.12 â†’ v1.0.13ï¼šçª—å£å°ºå¯¸ä¼˜åŒ–

#### ä¸»è¦æ”¹è¿›
- **çª—å£å°ºå¯¸å‡çº§**ï¼š1200Ã—800 â†’ 1480Ã—900
- **æœ€å°å°ºå¯¸è°ƒæ•´**ï¼š1000Ã—700 â†’ 1200Ã—750
- **ç”¨æˆ·ä½“éªŒæå‡**ï¼š23%æ›´å®½çš„æ˜¾ç¤ºç©ºé—´

#### æŠ€æœ¯å®ç°
```json
// src-tauri/tauri.conf.json
"windows": [{
  "width": 1480,
  "height": 900,
  "minWidth": 1200,
  "minHeight": 750,
  "center": true,
  "resizable": true
}]
```

#### å‘å¸ƒæ—¶é—´
2025å¹´7æœˆ31æ—¥

### v1.0.13 â†’ v1.0.15ï¼šæ›´æ–°å¼¹çª—ä¼˜åŒ–

#### ä¸»è¦æ”¹è¿›
- **ç§»é™¤è°ƒè¯•å¼¹çª—**ï¼šæ¸…ç†å¤šä½™çš„toastæç¤º
- **ç®€åŒ–ç”¨æˆ·ä½“éªŒ**ï¼šåªä¿ç•™å…³é”®æ›´æ–°é€šçŸ¥
- **ç•Œé¢ä¼˜åŒ–**ï¼šæ·¡ç»¿è‰²æ›´æ–°æç¤ºå¼¹çª—

#### å…·ä½“ä¿®æ”¹
ç§»é™¤çš„è°ƒè¯•æç¤ºï¼š
- `ğŸŒ æ­£åœ¨å‘é€æ›´æ–°æ£€æŸ¥è¯·æ±‚...`
- `ğŸ“„ APIå“åº”è¯¦æƒ…`
- `ğŸ” æ­£åœ¨æ£€æŸ¥åº”ç”¨æ›´æ–°...`
- `ğŸ› è°ƒè¯•ä¿¡æ¯è¯¦æƒ…`

ä¿ç•™çš„å…³é”®æç¤ºï¼š
- `ğŸ‰ å‘ç°æ–°ç‰ˆæœ¬ v${version}` (æ·¡ç»¿è‰²)
- `âœ… å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬`
- `âœ… å·²æ‰“å¼€ä¸‹è½½é¡µé¢`

#### å‘å¸ƒæ—¶é—´
2025å¹´7æœˆ31æ—¥

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### çª—å£å°ºå¯¸ä¼˜åŒ–æŠ€æœ¯ç»†èŠ‚

#### è®¾è®¡è€ƒè™‘
- **ç°ä»£æ˜¾ç¤ºå™¨é€‚é…**ï¼šé€‚åº”1920Ã—1080åŠä»¥ä¸Šåˆ†è¾¨ç‡
- **å†…å®¹æ˜¾ç¤ºä¼˜åŒ–**ï¼šæ›´å®½æ•çš„ç•Œé¢å¸ƒå±€
- **ç”¨æˆ·ä½“éªŒå¹³è¡¡**ï¼šä¿æŒè‰¯å¥½çš„å¯ç”¨æ€§

#### å®ç°æ•ˆæœ
| é¡¹ç›® | v1.0.12 | v1.0.15 | æ”¹è¿› |
|------|---------|---------|------|
| é»˜è®¤å®½åº¦ | 1200px | 1480px | +280px (23%) |
| é»˜è®¤é«˜åº¦ | 800px | 900px | +100px (12.5%) |
| æœ€å°å®½åº¦ | 1000px | 1200px | +200px |
| æœ€å°é«˜åº¦ | 700px | 750px | +50px |

### æ›´æ–°å¼¹çª—ä¼˜åŒ–æŠ€æœ¯ç»†èŠ‚

#### ä»£ç ä¿®æ”¹ç¤ºä¾‹
```typescript
// ä¿®æ”¹å‰ï¼šå¤šä¸ªè°ƒè¯•å¼¹çª—
toast.info('ğŸŒ æ­£åœ¨å‘é€æ›´æ–°æ£€æŸ¥è¯·æ±‚...', {
  description: 'å‘ www.yujinkeji.asia å‘é€è¯·æ±‚',
  duration: 3000
})

// ä¿®æ”¹åï¼šé™é»˜å¤„ç†
// é™é»˜æ£€æŸ¥æ›´æ–°ï¼Œä¸æ˜¾ç¤ºä¸­é—´è¿‡ç¨‹æç¤º
```

#### ä¿ç•™çš„æ ¸å¿ƒå¼¹çª—
```typescript
// å‘ç°æ›´æ–°æ—¶çš„å…³é”®æç¤º
toast.success(`ğŸ‰ å‘ç°æ–°ç‰ˆæœ¬ v${update.version}`, {
  description: 'ç‚¹å‡»ç«‹å³æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬',
  duration: 8000,
  action: {
    label: 'ç«‹å³æ›´æ–°',
    onClick: () => setShowDialog(true)
  }
})
```

---

## ğŸ“¦ å®Œæ•´ç‰ˆæœ¬å‘å¸ƒæµç¨‹

### ç¬¬1æ­¥ï¼šç‰ˆæœ¬å‡†å¤‡
```bash
# 1. æ›´æ–°ç‰ˆæœ¬æ•°æ®
# ç¼–è¾‘ lib/version-data.tsï¼ˆåœ¨æ•°ç»„å¼€å¤´æ·»åŠ æ–°ç‰ˆæœ¬ï¼‰

# 2. æ›´æ–°é…ç½®æ–‡ä»¶
# ç¼–è¾‘ src-tauri/tauri.conf.json ç‰ˆæœ¬å·
# ç¡®è®¤ productName ä¸º "csch"

# 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run tauri:build

# 4. ç¡®è®¤ç”Ÿæˆæ–‡ä»¶
# æ£€æŸ¥ csch_x.x.x_x64-setup.exe æ˜¯å¦ç”Ÿæˆ
```

### ç¬¬2æ­¥ï¼šGitæ“ä½œ
```bash
git add .
git commit -m "feat: å‘å¸ƒç‰ˆæœ¬ v1.0.x - åŠŸèƒ½æè¿°"
git tag v1.0.x
git push origin master
git push origin v1.0.x
```

### ç¬¬3æ­¥ï¼šGitHub Release
1. è®¿é—®ï¼šhttps://github.com/XUXIKAI886/zhuomianhejizidonggengx/releases
2. ç‚¹å‡» "Create a new release"
3. é€‰æ‹©æ ‡ç­¾ï¼šv1.0.x
4. å¡«å†™æ ‡é¢˜å’Œæè¿°
5. ä¸Šä¼  `.exe` å®‰è£…åŒ…
6. ç‚¹å‡» "Publish release"

### ç¬¬4æ­¥ï¼šæ›´æ–°æœåŠ¡å™¨é…ç½®
```bash
curl -X POST "https://www.yujinkeji.asia/api/releases" \
  -H "Authorization: Bearer chengshang-admin-token-2025-secure-update-server-key" \
  -H "Content-Type: application/json" \
  -d '{
    "target": "windows-x86_64",
    "version": "1.0.x",
    "notes": "æ›´æ–°è¯´æ˜...",
    "signature": "dW50cnVzdGVkIGNvbW1lbnQ6IHJzdCBzaWduaW5nIGNyeXB0b2dyYXBoaWNhbGx5IHNlY3VyZSBzaWduYXR1cmVzIGFyZSBhdmFpbGFibGUgZm9yIGluc3RhbGxpbmdcblJXU0JBSG9yOEJlSkcxZ3pPdmJTZ2VoZTE2amQ2",
    "url": "https://github.com/XUXIKAI886/zhuomianhejizidonggengx/releases/download/v1.0.x/csch_1.0.x_x64-setup.exe"
  }'
```

---

## ğŸ§ª æœåŠ¡å™¨é…ç½®å’ŒéªŒè¯æ–¹æ³•

### æœåŠ¡å™¨é…ç½®éªŒè¯
```bash
# 1. æ£€æŸ¥æœåŠ¡å™¨å¥åº·çŠ¶æ€
curl "https://www.yujinkeji.asia/health"

# 2. æµ‹è¯•æ—§ç‰ˆæœ¬èƒ½å¦æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬
curl "https://www.yujinkeji.asia/api/releases/windows-x86_64/æ—§ç‰ˆæœ¬å·"
# æœŸæœ›ï¼šè¿”å›æ–°ç‰ˆæœ¬ä¿¡æ¯

# 3. æµ‹è¯•æ–°ç‰ˆæœ¬æ˜¯å¦è¿”å›æ— æ›´æ–°
curl "https://www.yujinkeji.asia/api/releases/windows-x86_64/æ–°ç‰ˆæœ¬å·"  
# æœŸæœ›ï¼šè¿”å›ç©ºå¹³å°ä¿¡æ¯ "platforms": {}
```

### APIå“åº”ç¤ºä¾‹
```json
// æœ‰æ›´æ–°æ—¶çš„å“åº”
{
  "version": "1.0.15",
  "notes": "Update notification optimization...",
  "pub_date": "2025-07-31T07:24:35.068Z",
  "platforms": {
    "windows-x86_64": {
      "signature": "...",
      "url": "https://github.com/..."
    }
  }
}

// æ— æ›´æ–°æ—¶çš„å“åº”
{
  "version": "1.0.15",
  "notes": "",
  "pub_date": null,
  "platforms": {}
}
```

---

## âœ… ä¿®å¤æˆæœæ€»ç»“

### è§£å†³çš„æ ¸å¿ƒé—®é¢˜
1. âœ… **IPCé€šä¿¡å¤±è´¥** - é€šè¿‡CSPé…ç½®å’Œfallbackæœºåˆ¶è§£å†³
2. âœ… **ç‰ˆæœ¬æ£€æµ‹é”™è¯¯** - å®ç°å¤šå±‚ç‰ˆæœ¬è·å–ç­–ç•¥
3. âœ… **ç”¨æˆ·ä½“éªŒé—®é¢˜** - ä¼˜åŒ–çª—å£å°ºå¯¸å’Œæ›´æ–°æç¤º
4. âœ… **ç•Œé¢å†—ä½™ä¿¡æ¯** - æ¸…ç†è°ƒè¯•å¼¹çª—ï¼Œç®€åŒ–ç”¨æˆ·ç•Œé¢

### æŠ€æœ¯æ”¹è¿›æˆæœ
- **å¯é æ€§æå‡**ï¼šHTTP APIæ›¿ä»£ä¸ç¨³å®šçš„IPCé€šä¿¡
- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šæ›´å¤§çª—å£å°ºå¯¸å’Œæ¸…çˆ½çš„æ›´æ–°æç¤º
- **ç»´æŠ¤æ€§å¢å¼º**ï¼šæ¸…æ™°çš„ç‰ˆæœ¬å‘å¸ƒæµç¨‹å’Œæ–‡æ¡£
- **ç¨³å®šæ€§ä¿è¯**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œfallbackæœºåˆ¶

### ç‰ˆæœ¬å‘å¸ƒè§„èŒƒåŒ–
- **æ ‡å‡†åŒ–æµç¨‹**ï¼šå››æ­¥å‘å¸ƒæµç¨‹ç¡®ä¿å®Œæ•´æ€§
- **è‡ªåŠ¨åŒ–éªŒè¯**ï¼šæœåŠ¡å™¨é…ç½®éªŒè¯ç¡®ä¿åŠŸèƒ½æ­£å¸¸
- **æ–‡æ¡£å®Œå–„**ï¼šè¯¦ç»†è®°å½•æ¯ä¸ªç‰ˆæœ¬çš„æ”¹è¿›å†…å®¹

---

## ğŸ“ ç»´æŠ¤è”ç³»ä¿¡æ¯

- **GitHubä»“åº“**: https://github.com/XUXIKAI886/zhuomianhejizidonggengx
- **æ›´æ–°æœåŠ¡å™¨**: https://www.yujinkeji.asia
- **æœåŠ¡å™¨çŠ¶æ€**: https://www.yujinkeji.asia/health
- **ç‰ˆæœ¬å‘å¸ƒ**: https://github.com/XUXIKAI886/zhuomianhejizidonggengx/releases

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025å¹´7æœˆ31æ—¥  
**æœ€åæ›´æ–°**ï¼šv1.0.15ç‰ˆæœ¬å‘å¸ƒå®Œæˆ  
**ç»´æŠ¤çŠ¶æ€**ï¼šæŒç»­ç»´æŠ¤ä¸­
