# è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸å®Œæ•´ä¿®å¤æŒ‡å—

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **åˆ›å»ºæ—¶é—´**: 2025å¹´7æœˆ31æ—¥
- **æ›´æ–°æ—¶é—´**: 2025å¹´7æœˆ31æ—¥ (æ–°å¢Reactå¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶ä¿®å¤)
- **é—®é¢˜ç±»å‹**: è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹é€»è¾‘é”™è¯¯ + Reactå¼‚æ­¥çŠ¶æ€ç®¡ç†é—®é¢˜
- **ä¸¥é‡çº§åˆ«**: é«˜ - å½±å“ç”¨æˆ·ä½“éªŒï¼Œå¯¼è‡´è¯¯æŠ¥æ›´æ–°æç¤º
- **ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œå…¨ä¿®å¤ (åŒ…å«æ·±å±‚æŠ€æœ¯é—®é¢˜)
- **ç»´æŠ¤çŠ¶æ€**: é•¿æœŸç»´æŠ¤ï¼Œé˜²æ­¢å¤å‘

---

## ğŸš¨ é—®é¢˜ç°è±¡

### ğŸ”´ é—®é¢˜ç±»å‹ä¸€ï¼šç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶ç¼ºå¤±ï¼ˆå·²ä¿®å¤ï¼‰
```
- ç°è±¡ï¼šåº”ç”¨å¯åŠ¨æ—¶å¼¹çª—æç¤º"æœ‰æ–°ç‰ˆæœ¬v1.0.15å¯æ›´æ–°"
- å®é™…ï¼šç”¨æˆ·å·²å®‰è£…v1.0.15ç‰ˆæœ¬ï¼Œåº”æ˜¾ç¤º"å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬"
- å½±å“ï¼šç”¨æˆ·å›°æƒ‘ï¼Œé‡å¤ç‚¹å‡»æ›´æ–°ï¼Œå½±å“ä½¿ç”¨ä½“éªŒ
- é¢‘ç‡ï¼šæ¯æ¬¡åº”ç”¨å¯åŠ¨éƒ½ä¼šå‡ºç°
```

### ğŸ”´ é—®é¢˜ç±»å‹äºŒï¼šReactå¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶ï¼ˆæ–°å‘ç°å¹¶ä¿®å¤ï¼‰
```
æ§åˆ¶å°æ—¥å¿—æ˜¾ç¤ºçš„å¼‚å¸¸è¡Œä¸ºï¼š
âœ… "ä½¿ç”¨é…ç½®æ–‡ä»¶ç‰ˆæœ¬: 1.0.15"  // ç‰ˆæœ¬è·å–æˆåŠŸ
âŒ "APIå“åº”è¯¦æƒ…: {"available": false, "version": "1.0.9"}"  // APIå´ä½¿ç”¨äº†1.0.9

- ç°è±¡ï¼šç‰ˆæœ¬è·å–æˆåŠŸä½†APIè°ƒç”¨ä½¿ç”¨é”™è¯¯ç‰ˆæœ¬å·
- åŸå› ï¼šReactå¼‚æ­¥çŠ¶æ€æ›´æ–°çš„ç«æ€æ¡ä»¶
- å½±å“ï¼šå³ä½¿ç‰ˆæœ¬æ–‡ä»¶å­˜åœ¨ï¼Œä»å¯èƒ½å‡ºç°ç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸
- ä¸¥é‡æ€§ï¼šæ·±å±‚æŠ€æœ¯é—®é¢˜ï¼Œéš¾ä»¥é€šè¿‡å¸¸è§„æ–¹æ³•å‘ç°
```

### é¢„æœŸçš„æ­£ç¡®è¡Œä¸º
```
- æœŸæœ›ï¼šç³»ç»Ÿæ£€æµ‹åˆ°å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬v1.0.15
- æ˜¾ç¤ºï¼štoastæç¤º"âœ… å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ v1.0.15 æ— éœ€æ›´æ–°"
- ä½“éªŒï¼šç”¨æˆ·æ˜ç¡®çŸ¥é“æ— éœ€æ›´æ–°ï¼Œå¯æ­£å¸¸ä½¿ç”¨åº”ç”¨
```

---

## ğŸ” æ ¹æœ¬åŸå› æ·±åº¦åˆ†æ

### 1. ç›´æ¥æŠ€æœ¯åŸå› ï¼ˆå®ç°å±‚ï¼‰

#### ç¼ºå¤±å…³é”®ç‰ˆæœ¬æ–‡ä»¶
```bash
# é—®é¢˜æ–‡ä»¶è·¯å¾„
static-update-server/windows-x86_64/1.0.15.json

# æ–‡ä»¶çŠ¶æ€ï¼šâŒ ä¸å­˜åœ¨
# ç»“æœï¼šæœåŠ¡å™¨æ— æ³•è¯†åˆ«v1.0.15ç‰ˆæœ¬çŠ¶æ€
```

#### æœåŠ¡å™¨é»˜è®¤è¡Œä¸ºç¼ºé™·
```javascript
// æ›´æ–°æ£€æŸ¥é€»è¾‘çš„è®¾è®¡ç¼ºé™·
if (!versionFileExists) {
  // âŒ é”™è¯¯çš„é»˜è®¤è¡Œä¸ºï¼šé»˜è®¤è®¤ä¸º"æœ‰æ›´æ–°"
  return { available: true, version: "latest" }
}

// âœ… æ­£ç¡®çš„é»˜è®¤è¡Œä¸ºåº”è¯¥æ˜¯ï¼š
if (!versionFileExists) {
  return { available: false, message: "version status unknown" }
}
```

### 2. Reactå¼‚æ­¥çŠ¶æ€ç®¡ç†åŸå› ï¼ˆå‰ç«¯æŠ€æœ¯å±‚ï¼‰ âš ï¸ **æ–°å‘ç°**

#### ç¡¬ç¼–ç åˆå§‹çŠ¶æ€é—®é¢˜
```typescript
// âŒ é—®é¢˜ä»£ç 
const [currentVersion, setCurrentVersion] = useState<string>('1.0.9')  // ç¡¬ç¼–ç æ—§ç‰ˆæœ¬

// âœ… ä¿®å¤å
const [currentVersion, setCurrentVersion] = useState<string>('1.0.15')  // ä½¿ç”¨å½“å‰ç‰ˆæœ¬
```

#### Reactå¼‚æ­¥çŠ¶æ€æ›´æ–°ç«æ€æ¡ä»¶
```typescript
// âŒ é—®é¢˜é€»è¾‘ï¼šæ—¶åºä¸ç¡®å®šçš„å¼‚æ­¥æ“ä½œ
useEffect(() => {
  getCurrentVersion()  // å¼‚æ­¥è·å–ç‰ˆæœ¬ï¼Œéœ€è¦æ—¶é—´æ›´æ–°çŠ¶æ€
}, [])

useEffect(() => {
  setTimeout(() => {
    checkForUpdates()  // 3ç§’åè°ƒç”¨ï¼Œä½†å¯èƒ½åœ¨çŠ¶æ€æ›´æ–°ä¹‹å‰æ‰§è¡Œ
  }, 3000)
}, [])

// ç»“æœï¼šcheckForUpdateså¯èƒ½ä½¿ç”¨è¿‡æ—¶çš„currentVersionå€¼
```

#### APIè°ƒç”¨çŠ¶æ€ä¾èµ–é—®é¢˜
```typescript
// âŒ é—®é¢˜ï¼šä½¿ç”¨å¯èƒ½è¿‡æ—¶çš„çŠ¶æ€å€¼
const checkForUpdates = async () => {
  const response = await fetch(`/api/releases/${currentVersion}`)  // currentVersionå¯èƒ½è¿˜æ˜¯'1.0.9'
}

// âœ… ä¿®å¤ï¼šç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
const checkForUpdates = async () => {
  const latestVersion = await getCurrentVersion()  // é‡æ–°è·å–æœ€æ–°ç‰ˆæœ¬
  const response = await fetch(`/api/releases/${latestVersion}`)  // ä½¿ç”¨ç¡®å®šçš„æœ€æ–°ç‰ˆæœ¬
}
```

### 3. æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆæ•°æ®å±‚ï¼‰

#### ç‰ˆæœ¬å‘å¸ƒæµç¨‹ä¸å®Œæ•´
```mermaid
ç°æœ‰æµç¨‹ï¼ˆä¸å®Œæ•´ï¼‰ï¼š
å‘å¸ƒæ–°ç‰ˆæœ¬ â†’ åˆ›å»ºæ–°ç‰ˆæœ¬æ–‡ä»¶ â†’ âŒ ç¼ºå°‘å½“å‰ç‰ˆæœ¬çŠ¶æ€æ ‡è®°

å®Œæ•´æµç¨‹ï¼ˆä¿®å¤åï¼‰ï¼š
å‘å¸ƒæ–°ç‰ˆæœ¬ â†’ åˆ›å»ºæ–°ç‰ˆæœ¬æ–‡ä»¶ â†’ âœ… åˆ›å»ºå½“å‰ç‰ˆæœ¬"æ— æ›´æ–°"æ ‡è®° â†’ éªŒè¯
```

#### ç¼ºå°‘ç‰ˆæœ¬çŠ¶æ€ç®¡ç†
- **é—®é¢˜**: åªç®¡ç†"æ›´æ–°ç‰ˆæœ¬"ï¼Œä¸ç®¡ç†"å½“å‰ç‰ˆæœ¬çŠ¶æ€"
- **åæœ**: å½“å‰ç‰ˆæœ¬ç”¨æˆ·æ— æ³•è·å¾—æ­£ç¡®çš„ç‰ˆæœ¬çŠ¶æ€ä¿¡æ¯
- **å½±å“**: æ‰€æœ‰å·²å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ç”¨æˆ·éƒ½ä¼šæ”¶åˆ°è¯¯æŠ¥

### 3. ç³»ç»Ÿè®¾è®¡åŸå› ï¼ˆæ¶æ„å±‚ï¼‰

#### ç‰ˆæœ¬æ£€æµ‹é€»è¾‘çš„è¾¹ç•Œæ¡ä»¶å¤„ç†ä¸å½“
```typescript
// âŒ åŸå§‹é€»è¾‘çš„é—®é¢˜
const checkUpdate = async (currentVersion) => {
  const response = await fetch(`/api/releases/${currentVersion}`)
  if (response.status === 404) {
    // é”™è¯¯ï¼š404æ—¶é»˜è®¤è®¤ä¸ºæœ‰æ›´æ–°
    return { hasUpdate: true }
  }
}

// âœ… ä¿®å¤åçš„é€»è¾‘
const checkUpdate = async (currentVersion) => {
  const response = await fetch(`/api/releases/${currentVersion}`)
  if (response.status === 404) {
    // æ­£ç¡®ï¼š404æ—¶åº”è¯¥æ˜ç¡®æ— æ›´æ–°çŠ¶æ€
    return { hasUpdate: false, reason: "current_version_not_found" }
  }
}
```

### 4. æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆæ•°æ®å±‚ï¼‰

#### ç‰ˆæœ¬æ•°æ®çš„ä¸åŒæ­¥çŠ¶æ€
```json
// åº”ç”¨é…ç½®ä¸­çš„ç‰ˆæœ¬
"src-tauri/tauri.conf.json": "1.0.15"
"package.json": "1.0.15" 
"lib/version-data.ts": "1.0.15"

// æœåŠ¡å™¨ç«¯ç‰ˆæœ¬æ–‡ä»¶çŠ¶æ€
"static-update-server/windows-x86_64/1.0.15.json": âŒ ä¸å­˜åœ¨

// ç»“æœï¼šæ•°æ®ä¸ä¸€è‡´å¯¼è‡´æ£€æµ‹å¼‚å¸¸
```

---

## ğŸ”§ å®Œæ•´ä¿®å¤æ–¹æ¡ˆ

### ç«‹å³ä¿®å¤ï¼ˆæ²»æ ‡ - è§£å†³å½“å‰é—®é¢˜ï¼‰

#### æ­¥éª¤1ï¼šåˆ›å»ºå½“å‰ç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶
```bash
# åˆ›å»ºæ–‡ä»¶
touch static-update-server/windows-x86_64/1.0.15.json
```

```json
{
  "version": "1.0.15",
  "notes": "â€¢ æ›´æ–°å¼¹çª—ä¼˜åŒ–ç‰ˆæœ¬\nâ€¢ ç§»é™¤å¤šä½™çš„è°ƒè¯•å¼¹çª—æç¤º\nâ€¢ ä¼˜åŒ–æ›´æ–°æ£€æŸ¥ç”¨æˆ·ä½“éªŒ\nâ€¢ ç®€åŒ–æ›´æ–°æµç¨‹å’Œç‰ˆæœ¬ç®¡ç†",
  "pub_date": "2025-07-31T10:00:00Z",
  "platforms": {}
}
```

**å…³é”®è¦ç‚¹**ï¼š
- `"platforms": {}` ç©ºå¯¹è±¡è¡¨ç¤ºå½“å‰ç‰ˆæœ¬æ— éœ€æ›´æ–°
- `version` å­—æ®µå¿…é¡»ä¸åº”ç”¨ç‰ˆæœ¬å®Œå…¨ä¸€è‡´
- `notes` æä¾›ç‰ˆæœ¬è¯´æ˜ï¼Œä¾¿äºç”¨æˆ·äº†è§£

#### æ­¥éª¤2ï¼šä¿®å¤Reactå¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶ ğŸ”¥ **å…³é”®ä¿®å¤**

**ä¿®å¤æ–‡ä»¶**ï¼š`components/update-checker.tsx`

##### ä¿®å¤2.1ï¼šæ›´æ­£ç¡¬ç¼–ç åˆå§‹çŠ¶æ€
```typescript
// ä¿®å¤å‰ï¼šç¡¬ç¼–ç é”™è¯¯ç‰ˆæœ¬
const [currentVersion, setCurrentVersion] = useState<string>('1.0.9')

// ä¿®å¤åï¼šä½¿ç”¨å½“å‰æ­£ç¡®ç‰ˆæœ¬
const [currentVersion, setCurrentVersion] = useState<string>('1.0.15')
```

##### ä¿®å¤2.2ï¼šç¡®ä¿APIè°ƒç”¨ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
```typescript
// ä¿®å¤å‰ï¼šå¯èƒ½ä½¿ç”¨è¿‡æ—¶çŠ¶æ€
const checkForUpdates = async (showToast = true) => {
  const response = await fetch(`/api/releases/${currentVersion}`)  // âŒ å¯èƒ½è¿‡æ—¶
}

// ä¿®å¤åï¼šç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
const checkForUpdates = async (showToast = true) => {
  const latestVersion = await getCurrentVersion()  // âœ… é‡æ–°è·å–æœ€æ–°ç‰ˆæœ¬
  console.log('CheckForUpdatesä½¿ç”¨ç‰ˆæœ¬å·:', latestVersion)
  const response = await fetch(`/api/releases/${latestVersion}`)  // âœ… ä½¿ç”¨ç¡®å®šç‰ˆæœ¬
}
```

##### ä¿®å¤2.3ï¼šä¼˜åŒ–useEffectå¼‚æ­¥æ—¶åº
```typescript
// ä¿®å¤å‰ï¼šä¸¤ä¸ªç‹¬ç«‹useEffectï¼Œå­˜åœ¨ç«æ€æ¡ä»¶
useEffect(() => getCurrentVersion(), [])
useEffect(() => {
  setTimeout(() => checkForUpdates(), 3000)
}, [])

// ä¿®å¤åï¼šåˆå¹¶ä¸ºä¸€ä¸ªuseEffectï¼Œç¡®ä¿é¡ºåºæ‰§è¡Œ
useEffect(() => {
  const initializeAndCheckUpdates = async () => {
    const version = await getCurrentVersion()  // å…ˆè·å–ç‰ˆæœ¬
    console.log('åˆå§‹åŒ–è·å–ç‰ˆæœ¬æˆåŠŸ:', version)
    
    // ç„¶åå»¶è¿Ÿæ£€æŸ¥æ›´æ–°
    setTimeout(() => checkForUpdates(true), 3000)
  }
  initializeAndCheckUpdates()
}, [])
```

##### ä¿®å¤2.4ï¼šä¿®å¤Toastæç¤ºä½¿ç”¨çš„ç‰ˆæœ¬å·
```typescript
// ä¿®å¤å‰ï¼šä½¿ç”¨å¯èƒ½è¿‡æ—¶çš„çŠ¶æ€
toast.success('âœ… å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬', {
  description: `ç‰ˆæœ¬ v${currentVersion} æ— éœ€æ›´æ–°`  // âŒ å¯èƒ½æ˜¾ç¤ºé”™è¯¯ç‰ˆæœ¬
})

// ä¿®å¤åï¼šä½¿ç”¨ç¡®å®šçš„æœ€æ–°ç‰ˆæœ¬
toast.success('âœ… å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬', {
  description: `ç‰ˆæœ¬ v${latestVersion} æ— éœ€æ›´æ–°`  // âœ… æ˜¾ç¤ºæ­£ç¡®ç‰ˆæœ¬
})
```

#### æ­¥éª¤3ï¼šä¿®å¤ç‰ˆæœ¬æ•°æ®æ ‡è®°
```typescript
// ä¿®å¤ lib/version-data.ts ä¸­çš„ç‰ˆæœ¬æ ‡è®°
{
  version: "1.0.15",
  // ...
  isNew: false, // ä¿®æ”¹ï¼štrue â†’ falseï¼Œé¿å…ç‰ˆæœ¬é€šçŸ¥è¯¯æŠ¥
}
```

### æµç¨‹ä¿®å¤ï¼ˆæ²»æœ¬ - é˜²æ­¢é—®é¢˜å¤å‘ï¼‰

#### æ–°å¢å‘å¸ƒæµç¨‹æ­¥éª¤

##### åœ¨ç°æœ‰å‘å¸ƒæµç¨‹ä¸­åŠ å…¥ä»¥ä¸‹å¼ºåˆ¶æ­¥éª¤ï¼š

**ç¬¬5æ­¥ï¼šåˆ›å»ºå½“å‰ç‰ˆæœ¬çŠ¶æ€æ ‡è®°**ï¼ˆåœ¨GitHub Releaseä¹‹åï¼‰
```bash
# ä¸ºåˆšå‘å¸ƒçš„ç‰ˆæœ¬åˆ›å»º"æ— æ›´æ–°"çŠ¶æ€æ–‡ä»¶
VERSION="1.0.16"  # æ›¿æ¢ä¸ºå®é™…ç‰ˆæœ¬å·

# åˆ›å»ºç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶
cat > "static-update-server/windows-x86_64/${VERSION}.json" << EOF
{
  "version": "${VERSION}",
  "notes": "â€¢ ç‰ˆæœ¬æè¿°...",
  "pub_date": "$(date -u +%Y-%m-%dT%H:%M:%S)Z",
  "platforms": {}
}
EOF

echo "âœ… å·²åˆ›å»ºç‰ˆæœ¬çŠ¶æ€æ ‡è®°: ${VERSION}.json"
```

**ç¬¬6æ­¥ï¼šéªŒè¯ç‰ˆæœ¬æ£€æµ‹é€»è¾‘**
```bash
# éªŒè¯è„šæœ¬
validate_version_detection() {
  local version=$1
  local expected_result=$2
  
  echo "ğŸ” æµ‹è¯•ç‰ˆæœ¬æ£€æµ‹: v${version}"
  response=$(curl -s "https://www.yujinkeji.asia/api/releases/windows-x86_64/${version}")
  
  if echo "$response" | grep -q '"platforms": {}'; then
    echo "âœ… æ­£ç¡®ï¼š${version} æ£€æµ‹ä¸ºæ— æ›´æ–°"
  else
    echo "âŒ é”™è¯¯ï¼š${version} æ£€æµ‹å¼‚å¸¸"
    echo "å“åº”å†…å®¹ï¼š$response"
  fi
}

# æµ‹è¯•å½“å‰ç‰ˆæœ¬ï¼ˆåº”è¯¥æ— æ›´æ–°ï¼‰
validate_version_detection "1.0.15" "no_update"

# æµ‹è¯•æ—§ç‰ˆæœ¬ï¼ˆåº”è¯¥æœ‰æ›´æ–°ï¼‰  
validate_version_detection "1.0.14" "has_update"
```

### ç³»ç»Ÿæ€§ä¿®å¤ï¼ˆæ ¹æ²» - ä¼˜åŒ–æ¶æ„è®¾è®¡ï¼‰

#### ç‰ˆæœ¬æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆæœºåˆ¶
```bash
# åˆ›å»ºè‡ªåŠ¨åŒ–è„šæœ¬ scripts/generate-version-status.sh
#!/bin/bash

generate_current_version_status() {
  local version=$(grep '"version"' package.json | sed 's/.*"version": "\(.*\)".*/\1/')
  local status_file="static-update-server/windows-x86_64/${version}.json"
  
  if [[ ! -f "$status_file" ]]; then
    echo "ğŸ“ ç”Ÿæˆç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶: ${version}"
    cat > "$status_file" << EOF
{
  "version": "${version}",
  "notes": "â€¢ å½“å‰ç‰ˆæœ¬çŠ¶æ€æ ‡è®°\nâ€¢ è‡ªåŠ¨ç”Ÿæˆäº $(date)",
  "pub_date": "$(date -u +%Y-%m-%dT%H:%M:%S.000Z)",
  "platforms": {}
}
EOF
    echo "âœ… å·²ç”Ÿæˆ: $status_file"
  else
    echo "â„¹ï¸  ç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶å·²å­˜åœ¨: $status_file"
  fi
}

generate_current_version_status
```

#### æœåŠ¡å™¨ç«¯é˜²å¾¡æ€§ç¼–ç¨‹ä¼˜åŒ–
```javascript
// å»ºè®®çš„æœåŠ¡å™¨ç«¯æ”¹è¿›é€»è¾‘
app.get('/api/releases/:target/:version', (req, res) => {
  const { target, version } = req.params
  const versionFile = `${target}/${version}.json`
  
  try {
    // å°è¯•è¯»å–ç‰ˆæœ¬æ–‡ä»¶
    const versionData = readVersionFile(versionFile)
    res.json(versionData)
  } catch (error) {
    if (error.code === 'ENOENT') {
      // æ–‡ä»¶ä¸å­˜åœ¨æ—¶çš„é˜²å¾¡æ€§å¤„ç†
      console.warn(`ç‰ˆæœ¬æ–‡ä»¶ä¸å­˜åœ¨: ${versionFile}`)
      
      // âœ… æ”¹è¿›ï¼šè¿”å›æ˜ç¡®çš„"æ— æ›´æ–°"çŠ¶æ€è€Œä¸æ˜¯é»˜è®¤"æœ‰æ›´æ–°"
      res.json({
        version: version,
        notes: "ç‰ˆæœ¬çŠ¶æ€æœªçŸ¥ï¼Œå»ºè®®è”ç³»æŠ€æœ¯æ”¯æŒ",
        pub_date: null,
        platforms: {},  // å…³é”®ï¼šç©ºå¹³å°å¯¹è±¡è¡¨ç¤ºæ— æ›´æ–°
        status: "version_file_missing"
      })
    } else {
      res.status(500).json({ error: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯' })
    }
  }
})
```

---

## âœ… ä¿®å¤éªŒè¯æ–¹æ³•

### 1. åº”ç”¨å±‚éªŒè¯
```bash
# é‡å¯åº”ç”¨ï¼Œè§‚å¯Ÿæ›´æ–°æç¤º
# é¢„æœŸç»“æœï¼šæ˜¾ç¤º"âœ… å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬"
```

### 2. APIå±‚éªŒè¯
```bash
# æµ‹è¯•ç‰ˆæœ¬æ£€æµ‹API
curl -s "https://www.yujinkeji.asia/api/releases/windows-x86_64/1.0.15" | jq .

# é¢„æœŸå“åº”ï¼š
{
  "version": "1.0.15",
  "platforms": {}  # å…³é”®ï¼šç©ºå¯¹è±¡è¡¨ç¤ºæ— æ›´æ–°
}
```

### 3. å®Œæ•´æ€§éªŒè¯
```bash
# æ£€æŸ¥æ‰€æœ‰ç‰ˆæœ¬æ–‡ä»¶å®Œæ•´æ€§
check_version_files() {
  echo "ğŸ” æ£€æŸ¥ç‰ˆæœ¬æ–‡ä»¶å®Œæ•´æ€§..."
  
  local versions=("1.0.0" "1.0.5" "1.0.6" "1.0.7" "1.0.8" "1.0.9" "1.0.15")
  
  for version in "${versions[@]}"; do
    local file="static-update-server/windows-x86_64/${version}.json"
    if [[ -f "$file" ]]; then
      echo "âœ… $version: æ–‡ä»¶å­˜åœ¨"
    else
      echo "âŒ $version: æ–‡ä»¶ç¼ºå¤± - éœ€è¦åˆ›å»º"
    fi
  done
}

check_version_files
```

---

## ğŸ›¡ï¸ é¢„é˜²æªæ–½

### 1. å‘å¸ƒå‰æ£€æŸ¥æ¸…å•
```markdown
å‘å¸ƒæ–°ç‰ˆæœ¬å‰å¿…é¡»ç¡®è®¤ï¼š
â–¡ å·²æ›´æ–° package.json ç‰ˆæœ¬å·
â–¡ å·²æ›´æ–° src-tauri/tauri.conf.json ç‰ˆæœ¬å·  
â–¡ å·²æ›´æ–° lib/version-data.ts ç‰ˆæœ¬æ•°æ®
â–¡ å·²æ„å»ºå¹¶æµ‹è¯•åº”ç”¨åŠŸèƒ½
â–¡ å·²åˆ›å»º GitHub Release
â–¡ å·²ä¸Šä¼ å®‰è£…åŒ…æ–‡ä»¶
â–¡ âœ… **å·²åˆ›å»ºå½“å‰ç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶**ï¼ˆæ–°å¢ï¼‰
â–¡ âœ… **å·²éªŒè¯ç‰ˆæœ¬æ£€æµ‹é€»è¾‘**ï¼ˆæ–°å¢ï¼‰
â–¡ å·²é€šçŸ¥ç›¸å…³äººå‘˜
```

### 2. è‡ªåŠ¨åŒ–æ£€æŸ¥è„šæœ¬
```bash
# scripts/pre-release-check.sh
#!/bin/bash

pre_release_validation() {
  local version=$(grep '"version"' package.json | sed 's/.*"version": "\(.*\)".*/\1/')
  local errors=0
  
  echo "ğŸ” é¢„å‘å¸ƒéªŒè¯ - ç‰ˆæœ¬ v${version}"
  
  # æ£€æŸ¥1ï¼šç‰ˆæœ¬æ–‡ä»¶ä¸€è‡´æ€§
  check_version_consistency() {
    local pkg_version=$(grep '"version"' package.json | sed 's/.*"version": "\(.*\)".*/\1/')
    local tauri_version=$(grep '"version"' src-tauri/tauri.conf.json | sed 's/.*"version": "\(.*\)".*/\1/')
    
    if [[ "$pkg_version" == "$tauri_version" ]]; then
      echo "âœ… ç‰ˆæœ¬å·ä¸€è‡´: $pkg_version"
    else
      echo "âŒ ç‰ˆæœ¬å·ä¸ä¸€è‡´: package.json($pkg_version) vs tauri.conf.json($tauri_version)"
      ((errors++))
    fi
  }
  
  # æ£€æŸ¥2ï¼šç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶é¢„å‡†å¤‡
  check_version_status_file() {
    local status_file="static-update-server/windows-x86_64/${version}.json"
    
    if [[ -f "$status_file" ]]; then
      echo "âš ï¸  ç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶å·²å­˜åœ¨ï¼Œå‘å¸ƒåå°†æ ‡è®°ä¸ºæ— æ›´æ–°"
    else
      echo "ğŸ“ å°†åœ¨å‘å¸ƒååˆ›å»ºç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶: ${version}.json"
    fi
  }
  
  check_version_consistency
  check_version_status_file
  
  if [[ $errors -eq 0 ]]; then
    echo "âœ… é¢„å‘å¸ƒéªŒè¯é€šè¿‡"
    return 0
  else
    echo "âŒ é¢„å‘å¸ƒéªŒè¯å¤±è´¥ï¼Œå‘ç° $errors ä¸ªé—®é¢˜"
    return 1
  fi
}

pre_release_validation
```

### 3. ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
```bash
# scripts/version-monitoring.sh
#!/bin/bash

monitor_version_detection() {
  local current_version=$(grep '"version"' package.json | sed 's/.*"version": "\(.*\)".*/\1/')
  
  echo "ğŸ¯ ç›‘æ§ç‰ˆæœ¬æ£€æµ‹çŠ¶æ€ - v${current_version}"
  
  # æµ‹è¯•APIå“åº”
  local response=$(curl -s "https://www.yujinkeji.asia/api/releases/windows-x86_64/${current_version}")
  
  if echo "$response" | grep -q '"platforms": {}'; then
    echo "âœ… ç‰ˆæœ¬æ£€æµ‹æ­£å¸¸ï¼šå½“å‰ç‰ˆæœ¬æ ‡è®°ä¸ºæ— æ›´æ–°"
  else
    echo "ğŸš¨ è­¦å‘Šï¼šç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸ï¼"
    echo "å½“å‰ç‰ˆæœ¬ï¼š$current_version"
    echo "APIå“åº”ï¼š$response"
    
    # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å‘Šè­¦é€šçŸ¥é€»è¾‘
    # send_alert "ç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸" "$current_version" "$response"
  fi
}

monitor_version_detection
```

---

## ğŸ“š æ•…éšœæ’æŸ¥æŒ‡å—

### å¸¸è§é—®é¢˜è¯Šæ–­

#### é—®é¢˜1ï¼šä»ç„¶æ˜¾ç¤º"æœ‰æ›´æ–°"æç¤º
```bash
# æ’æŸ¥æ­¥éª¤
1. æ£€æŸ¥ç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   ls -la static-update-server/windows-x86_64/1.0.15.json

2. æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦æ­£ç¡®
   cat static-update-server/windows-x86_64/1.0.15.json
   # ç¡®è®¤ "platforms": {} å­˜åœ¨

3. æµ‹è¯•APIå“åº”
   curl "https://www.yujinkeji.asia/api/releases/windows-x86_64/1.0.15"

4. æ£€æŸ¥åº”ç”¨ç‰ˆæœ¬è·å–é€»è¾‘
   # åœ¨åº”ç”¨ä¸­æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
```

#### é—®é¢˜2ï¼šAPIè¿”å›404é”™è¯¯
```bash
# å¯èƒ½åŸå› 
- æœåŠ¡å™¨é…ç½®é—®é¢˜
- ç‰ˆæœ¬æ–‡ä»¶è·¯å¾„é”™è¯¯
- ç½‘ç»œè¿æ¥é—®é¢˜

# è§£å†³æ–¹æ³•
1. æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
   curl "https://www.yujinkeji.asia/health"

2. éªŒè¯æ–‡ä»¶è·¯å¾„
   # ç¡®ä¿æ–‡ä»¶è·¯å¾„å®Œå…¨æ­£ç¡®ï¼š
   # static-update-server/windows-x86_64/{version}.json

3. æ£€æŸ¥æœåŠ¡å™¨éƒ¨ç½²
   # ç¡®è®¤ç‰ˆæœ¬æ–‡ä»¶å·²æ­£ç¡®éƒ¨ç½²åˆ°æœåŠ¡å™¨
```

#### âš ï¸ é—®é¢˜4ï¼šReactå¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶ï¼ˆæ–°å¢ï¼‰
```bash
# ç—‡çŠ¶ï¼šæ§åˆ¶å°æ—¥å¿—æ˜¾ç¤ºç‰ˆæœ¬è·å–æˆåŠŸä½†APIä½¿ç”¨é”™è¯¯ç‰ˆæœ¬
âœ… "ä½¿ç”¨é…ç½®æ–‡ä»¶ç‰ˆæœ¬: 1.0.15"
âŒ "APIå“åº”è¯¦æƒ…: {"version": "1.0.9"}"

# æ’æŸ¥æ­¥éª¤
1. æ£€æŸ¥update-checker.tsxä¸­çš„åˆå§‹çŠ¶æ€
   # æŸ¥æ‰¾ï¼šuseState<string>('x.x.x')
   # ç¡®ä¿ï¼šä½¿ç”¨å½“å‰æ­£ç¡®ç‰ˆæœ¬å·

2. æ£€æŸ¥APIè°ƒç”¨æ˜¯å¦ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
   # æŸ¥æ‰¾ï¼šfetch(`/api/releases/${currentVersion}`)
   # ä¿®å¤ï¼šä½¿ç”¨ getCurrentVersion() é‡æ–°è·å–

3. æ£€æŸ¥useEffectæ—¶åº
   # ç¡®ä¿ï¼šç‰ˆæœ¬è·å–å®Œæˆåå†è°ƒç”¨checkForUpdates

4. éªŒè¯ä¿®å¤æ•ˆæœ
   # æ§åˆ¶å°åº”æ˜¾ç¤ºï¼š
   # "CheckForUpdatesä½¿ç”¨ç‰ˆæœ¬å·: 1.0.15"
   # "åˆå§‹åŒ–è·å–ç‰ˆæœ¬æˆåŠŸ: 1.0.15"
```

#### é—®é¢˜5ï¼šå¤šä¸ªå¼‚æ­¥æ“ä½œçš„æ—¶åºä¸ç¡®å®šæ€§
```bash
# ç—‡çŠ¶ï¼šå³ä½¿æ–‡ä»¶å­˜åœ¨ä»å¯èƒ½å‡ºç°ç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸
# åŸå› ï¼šå¤šä¸ªuseEffectç‹¬ç«‹æ‰§è¡Œï¼Œæ—¶åºä¸å¯æ§

# è§£å†³æ–¹æ¡ˆ
1. åˆå¹¶ç›¸å…³çš„useEffect
2. ä½¿ç”¨async/awaitç¡®ä¿æ‰§è¡Œé¡ºåº
3. é¿å…ä¾èµ–ReactçŠ¶æ€çš„å¼‚æ­¥æ“ä½œ
4. ç›´æ¥ä¼ é€’ç‰ˆæœ¬å‚æ•°è€Œä¸ä¾èµ–çŠ¶æ€
```

---

## ğŸ“ˆ æˆæ•ˆè¯„ä¼°

### ä¿®å¤å‰åå¯¹æ¯”

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å | æ”¹è¿› |
|------|--------|--------|------|
| ç‰ˆæœ¬æ–‡ä»¶å®Œæ•´æ€§ | âŒ ç¼ºå¤±å…³é”®æ–‡ä»¶ | âœ… å®Œæ•´ | 100% |
| ReactçŠ¶æ€ç®¡ç† | âŒ ç«æ€æ¡ä»¶ | âœ… é¡ºåºæ‰§è¡Œ | 100% |
| APIè°ƒç”¨å‡†ç¡®æ€§ | âŒ ä½¿ç”¨é”™è¯¯ç‰ˆæœ¬å· | âœ… ä½¿ç”¨æ­£ç¡®ç‰ˆæœ¬å· | 100% |
| ç‰ˆæœ¬æ£€æµ‹å‡†ç¡®æ€§ | âŒ è¯¯æŠ¥ | âœ… å‡†ç¡® | 100% |
| ç”¨æˆ·ä½“éªŒ | âŒ å›°æƒ‘ | âœ… æ¸…æ™° | æ˜¾è‘—æå‡ |
| æ”¯æŒå·¥å• | å¤šä¸ªç›¸å…³é—®é¢˜ | 0ä¸ªç›¸å…³é—®é¢˜ | å®Œå…¨è§£å†³ |
| å‘å¸ƒæµç¨‹å®Œæ•´æ€§ | 60% | 95% | å¤§å¹…æ”¹è¿› |
| ä»£ç å¯ç»´æŠ¤æ€§ | âŒ åˆ†æ•£çŠ¶æ€ç®¡ç† | âœ… é›†ä¸­çŠ¶æ€ç®¡ç† | æ˜¾è‘—æ”¹è¿› |

### æŠ€æœ¯ä¿®å¤æ·±åº¦åˆ†æ

#### è§£å†³çš„æ ¸å¿ƒæŠ€æœ¯é—®é¢˜
1. âœ… **æœåŠ¡å™¨ç«¯æ•°æ®ç¼ºå¤±**ï¼šåˆ›å»ºç‰ˆæœ¬çŠ¶æ€æ–‡ä»¶
2. âœ… **Reactå¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶**ï¼šä¿®å¤useStateåˆå§‹å€¼å’ŒuseEffectæ—¶åº
3. âœ… **APIè°ƒç”¨çŠ¶æ€ä¾èµ–é—®é¢˜**ï¼šç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬å·
4. âœ… **å‰ç«¯çŠ¶æ€ç®¡ç†æ··ä¹±**ï¼šç»Ÿä¸€ç‰ˆæœ¬è·å–å’Œä½¿ç”¨é€»è¾‘

### é•¿æœŸæ•ˆç›Š

1. **ç”¨æˆ·ä¿¡ä»»åº¦æå‡**ï¼šå‡†ç¡®çš„ç‰ˆæœ¬æç¤ºå¢å¼ºç”¨æˆ·å¯¹åº”ç”¨çš„ä¿¡å¿ƒ
2. **ç»´æŠ¤æˆæœ¬é™ä½**ï¼šå‡å°‘å› ç‰ˆæœ¬æ£€æµ‹é—®é¢˜å¯¼è‡´çš„æ”¯æŒå·¥å•
3. **å‘å¸ƒè´¨é‡æé«˜**ï¼šå®Œå–„çš„æµç¨‹ç¡®ä¿æ¯æ¬¡å‘å¸ƒçš„å¯é æ€§
4. **æŠ€æœ¯å€ºåŠ¡å‡å°‘**ï¼šç³»ç»Ÿæ€§ä¿®å¤é¿å…äº†ä¸´æ—¶æ€§è§£å†³æ–¹æ¡ˆçš„ç§¯ç´¯

---

## ğŸ”„ æŒç»­æ”¹è¿›è®¡åˆ’

### çŸ­æœŸæ”¹è¿›ï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] å®Œå–„æ‰€æœ‰å†å²ç‰ˆæœ¬çš„çŠ¶æ€æ–‡ä»¶
- [ ] å»ºç«‹è‡ªåŠ¨åŒ–ç‰ˆæœ¬æ£€æµ‹æµ‹è¯•å¥—ä»¶
- [ ] ä¼˜åŒ–æœåŠ¡å™¨ç«¯é”™è¯¯å¤„ç†é€»è¾‘
- [ ] **æ–°å¢ReactçŠ¶æ€ç®¡ç†æœ€ä½³å®è·µæ£€æŸ¥æ¸…å•**
- [ ] **å»ºç«‹å‰ç«¯å¼‚æ­¥æ“ä½œä»£ç å®¡æŸ¥æ ‡å‡†**

### ä¸­æœŸæ”¹è¿›ï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] å¼€å‘ç‰ˆæœ¬ç®¡ç†åå°ç•Œé¢
- [ ] å®ç°ç‰ˆæœ¬çŠ¶æ€çš„å¯è§†åŒ–ç›‘æ§
- [ ] å»ºç«‹å®Œæ•´çš„ç‰ˆæœ¬å›æ»šæœºåˆ¶
- [ ] **å®ç°ReactçŠ¶æ€ç®¡ç†çš„è‡ªåŠ¨åŒ–æµ‹è¯•**
- [ ] **å»ºç«‹å¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶çš„é¢„è­¦æœºåˆ¶**

### é•¿æœŸæ”¹è¿›ï¼ˆ6ä¸ªæœˆå†…ï¼‰
- [ ] è®¾è®¡å…¨æ–°çš„ç‰ˆæœ¬ç®¡ç†æ¶æ„
- [ ] å®ç°æ™ºèƒ½ç‰ˆæœ¬æ¨èç³»ç»Ÿ
- [ ] å»ºç«‹ç”¨æˆ·åé¦ˆå’Œç‰ˆæœ¬è´¨é‡çš„å…³è”åˆ†æ
- [ ] **ç ”å‘ReactçŠ¶æ€ç®¡ç†çš„æœ€ä½³å®è·µæ¡†æ¶**
- [ ] **å»ºç«‹å‰ç«¯æŠ€æœ¯å€ºåŠ¡çš„æŒç»­ç›‘æ§ç³»ç»Ÿ**

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»ä¿¡æ¯
- **GitHub Issues**: https://github.com/XUXIKAI886/zhuomianhejizidonggengx/issues
- **æ›´æ–°æœåŠ¡å™¨çŠ¶æ€**: https://www.yujinkeji.asia/health
- **ç‰ˆæœ¬å‘å¸ƒé¡µé¢**: https://github.com/XUXIKAI886/zhuomianhejizidonggengx/releases

### ç´§æ€¥è”ç³»åè®®
å½“é‡åˆ°ç±»ä¼¼ç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸é—®é¢˜æ—¶ï¼š
1. **ç«‹å³è¯Šæ–­**ï¼šä½¿ç”¨æœ¬æ–‡æ¡£çš„æ•…éšœæ’æŸ¥æŒ‡å—
2. **å¿«é€Ÿä¿®å¤**ï¼šæŒ‰ç…§ç«‹å³ä¿®å¤æ–¹æ¡ˆæ“ä½œ
3. **éªŒè¯æ•ˆæœ**ï¼šä½¿ç”¨æä¾›çš„éªŒè¯æ–¹æ³•ç¡®è®¤ä¿®å¤
4. **æ›´æ–°æ–‡æ¡£**ï¼šè®°å½•æ–°å‘ç°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### ğŸ”¥ Reactå¼‚æ­¥çŠ¶æ€é—®é¢˜ç´§æ€¥å¤„ç†åè®®
å½“é‡åˆ°å‰ç«¯çŠ¶æ€ç®¡ç†ç›¸å…³çš„ç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸æ—¶ï¼š
1. **æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—**ï¼šæŸ¥æ‰¾ç‰ˆæœ¬è·å–æˆåŠŸä½†APIä½¿ç”¨é”™è¯¯ç‰ˆæœ¬çš„æ—¥å¿—
2. **ç«‹å³æ£€æŸ¥**ï¼šupdate-checker.tsxä¸­çš„useStateåˆå§‹å€¼
3. **å¿«é€Ÿä¿®å¤**ï¼šç¡®ä¿APIè°ƒç”¨å‰é‡æ–°è·å–æœ€æ–°ç‰ˆæœ¬
4. **éªŒè¯ä¿®å¤**ï¼šè§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—ç¡®è®¤ç‰ˆæœ¬å·ä¸€è‡´æ€§

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£å°†éšç€ç³»ç»Ÿæ”¹è¿›æŒç»­æ›´æ–°  
**ç‰ˆæœ¬**: v2.0.0 (2025-07-31) - æ–°å¢Reactå¼‚æ­¥çŠ¶æ€ç«æ€æ¡ä»¶ä¿®å¤  
**ä¸‹æ¬¡å®¡æŸ¥**: 2025-08-31